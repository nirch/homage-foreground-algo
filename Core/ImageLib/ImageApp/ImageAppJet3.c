/***************************
 ***   Image1AppJet3.c   ***
 ***************************/
#include <stdio.h>
#include <math.h>


#include	"Uigp/igp.h"


#include	"Ujet2/Jet23Type.h"

#include "ImageType/ImageType.h"

#include "ImageApp.h"

#define	SIZE	5



// 5X5  order=3 
int image1_app5_jet3( image_type *im, int i0, int j0, jet3_type *jet )
{
u_char	*b0,	*b1,	*b2,	*b3,	*b4;
float	jk[10];

    jk[0] = (float)(1/335.);
    jk[1] = jk[2] = (float)(1/150.);
    jk[3] = jk[5] = (float)(1.);
    jk[4] = (float)(1/9.);
    jk[6] = jk[9] = (float)(1/75.);
    jk[7] = jk[8] = (float)(1/25.);

    b0 = IMAGE_PIXEL(im, i0-2, j0-2 );
    b1 = b0 + im->width;
    b2 = b1 + im->width;
    b3 = b2 + im->width;
    b4 = b3 + im->width;

    jet->j[0] = 
      jk[0] *(71 * b2[2] +
	      54 * (b1[2] + b2[1] + b2[3] + b3[2]) +
	      37 * (b1[1] + b1[3] + b3[1] + b3[3]) -
	      14 * (b0[1] + b0[3] + b1[0] + b1[4] +
		    b3[0] + b3[4] + b4[1] + b4[3]) +
	      3  * (b0[2] + b2[0] + b2[4] + b4[2]) );

    jet->j[1] =
      jk[1] *(62 * (b3[1] + b3[3] - b1[1] - b1[3]) -
	      23 * (b4[1] + b4[3] - b0[1] - b0[3]) -
	      4  * (b3[0] + b3[4] - b1[0] - b1[4]) +
	      84 * (b3[2] - b1[2]) +
	      21 * (b4[2] - b0[2]) );

    jet->j[2] =
      jk[2] *(62 * (b1[3] + b3[3] - b1[1] - b3[1]) -
	      23 * (b1[4] + b3[4] - b1[0] - b3[0]) -
	      4  * (b0[3] + b4[3] - b0[1] - b4[1]) +
	      84 * (b2[3] - b2[1]) +
	      21 * (b2[4] - b2[0]) );

    jet->j[3] =
      0.196162052  * (b0[1] + b0[3] + b4[1] + b4[3]) +
      0.1620469092 * (b0[2] + b4[2]) +
      0.02473348856* (b1[0] + b1[4] + b3[0] + b3[4]) -
      0.077611928  * (b1[1] + b1[3] + b3[1] + b3[3]) -
      0.111727066  * (b1[2] + b3[2]) -
      0.0665245152 * (b2[0] + b2[4]) -
      0.168869934  * (b2[1] + b2[3]) -
      0.2029850768 *  b2[2]  ;

    jet->j[4] =
      jk[4] *( 2 *( b0[1] - b0[3] + b1[0] - b1[4] -
		    b3[0] + b3[4] - b4[1] + b4[3]) +
	       + b1[1] - b1[3] - b3[1] + b3[3] );

    jet->j[5] =
      0.196162052  * (b1[0] + b3[0] + b1[4] + b3[4]) +
      0.1620469092 * (b2[0] + b2[4]) +
      0.02473348856* (b0[1] + b4[1] + b0[3] + b4[3]) -
      0.077611928  * (b1[1] + b1[3] + b3[1] + b3[3]) -
      0.111727066  * (b2[1] + b2[3]) -
      0.0665245152 * (b0[2] + b4[2]) -
      0.168869934  * (b1[2] + b3[2]) -
      0.2029850768 *  b2[2]  ;

    jet->j[6] =
      jk[6] *( 22 * (b4[1] + b4[3] - b0[1] - b0[3]) +
	       6  * (b4[2] - b0[2]) +
	       4  * (b1[0] + b1[4] - b3[0] - b3[4]) +
	       28 * (b1[1] + b1[3] - b3[1] - b3[3]) +
	       36 * (b1[2] - b3[2]) );

    jet->j[7] =
      jk[7] *( 12 * (b0[3] - b0[1] + b2[1] - b2[3] - b4[1] + b4[3]) +
	       4  * (b1[4] - b1[0] - b3[0] + b3[4]) +
	       6  * (b1[1] - b1[3] + b3[1] - b3[3]) +
	       8  * (b2[0] - b2[4]) );

    jet->j[8] =
      jk[8] *( 12 * (b3[0] - b1[0] + b1[2] - b3[2] - b1[4] + b3[4]) +
	       4  * (b4[1] - b0[1] - b0[3] + b4[3]) +
	       6  * (b1[1] - b3[1] + b1[3] - b3[3]) +
	       8  * (b0[2] - b4[2]) );

    jet->j[9] =
      jk[9] *( 22 * (b1[4] + b3[4] - b1[0] - b3[0]) +
	       6  * (b2[4] - b2[0]) +
	       4  * (b0[1] + b4[1] - b0[3] - b4[3]) +
	       28 * (b1[1] + b3[1] - b1[3] - b3[3]) +
	       36 * (b2[1] - b2[3]) );


	return( 1 );
}



